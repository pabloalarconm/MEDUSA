#!/bin/bash

# sudo python3 uniq.py ${PWD}/data # In case of regenerate a new uniqid

declare -a StringArray=("personal_information" "patient_status" "care_pathway" "diagnosis" "disease_history" "genetic_diagnosis" "phenotyping" "undiagnosed" "patient_consent" "disability" )
# "personal_information" "patient_status" "care_pathway" "diagnosis" "disease_history" "genetic_diagnosis" "phenotyping" "undiagnosed" "patient_consent" "disability"
for val in ${StringArray[@]}; 
do
    cd ../../CDE-semantic-model-implementations/YARRRML_Transform_Templates/Builders_scripts_python/ # Fetch builders
    python3 builder_${val}.py > ../../../MEDUSA/trialCDE/config/pseudonym_yarrrml_template.yaml # Regenerate YARRRML using Python-based builder
    cd ../../../MEDUSA/trialCDE
    irb run_me_to_test.rb $val # Run Ruby-based RDF transformation

done

sudo python3 nt2ttl.py ${PWD}/data/triples # Transform resulting N3 files into Turtle
sudo chmod -R 777 .

for val in ${StringArray[@]}; 
do
    # Use Web tool to obtain CSV file using RDF to create Image:
    curl -X POST "http://178.63.49.197:5000/draw-io-utils/turtle-to-csv" -H "accept: text/csv" -H "Content-Type: multipart/form-data" -F "file=@/home/pabloalarconm/Desktop/EJP/MEDUSA/trialCDE/data/triples/${val}.ttl;type=text/turtle" > /home/pabloalarconm/Desktop/EJP/MEDUSA/trialCDE/drawio/${val}.csv
done